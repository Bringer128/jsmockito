<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>JsMockito - Simple & Better Javascript mocking</title>
  <style type="text/css">
body {font-family: arial, sans-serif;}
p {font-size:95%}
  </style>
</head>
<body>
<!--
<div id="news">
<h2>News</h2>
<ul>
</ul>
</div>
-->

<img src="jsmockito.png" height="120px" />

<h2>Why drink it?</h2>
<p>JsMockito is a JavaScript stub/mock framework heavily inspired by <a
href="http://mockito.org">Mockito</a>. To quote the mockito website:</p>

<blockquote><i>"Mockito is a mocking framework that tastes really good. It lets
you write beautiful tests with a clean & simple API. Mockito doesn't give you
a hangover because the tests are very readable and they produce clean
verification errors."</i></blockquote>

<p>JsMockito aims to try and reproduce the clean &amp; simple API, with a
JavaScript twist. And why not add some variation to your drinking habits?</p>

<h2>What do you serve it with?</h2>

<p>JsMockito must be served with
<a href="http://github.com/danielfm/jshamcrest/">JsHamcrest</a>. No only do
they go well together, it's essential to avoid a very nasty hangover.</p>

<h2>How to drink it?</h2>

<p>To use JsMockito with a JavaScript unit test framework, follow the usual
installation/configuration instructions for the framework and plug JsMockito
into it. If you're integrating with <a href="http://github.com/nkallen/screw-unit/tree/master">Screw.Unit</a>
(and why wouldn't you?) then you just need to make the following call:</p>

<pre>
    JsMockito.Integration.screwunit();
</pre>

<h3>Once installed, you can verify with interactions:</h3>

<pre>
    var mockedObject = mock(Array);
  
    // -- start code under test --
    mockedObject.push("one");
    // -- end code under test --
  
    verify(mockedObject).push("one");
</pre>

<h3>Or you can stub method calls:</h3>

<pre>
    var mockedObject = mock(MyClass);
  
    when(mockedObject).get(1).thenReturn("hello world");
    
    // -- start code under test --
    alert(mockedObject.getGreeting("initial"));
  
    // the following alerts 'true' as get(99) was not stubbed
    alert(typeof (mockedObject.get(99)) === 'undefined');
    // -- end code under test --
</pre>

<h3>For a JavaScript twist, you can also mock functions:</h3>

<pre>
    mockFunc = mockFunction();
    when(mockFunc).call(this, anything()).then(function(arg) {
      return "foo " + arg;
    });
  
    // -- start code under test --
    mockFunc("bar");
    // -- end code under test --
  
    verify(mockFunc)(anything());

    // or if you want to verify the scope it was called with, use:
    verify(mockFunc).call(this, anything())
</pre>

<h3>Mockitos are also good for spys</h3>

<p>Real super spies don't drink martinis - they go for mockitos. And just like
Mockito, JsMockito supports 'spying' on real functions and objects and verifing
how they were interacted with.</p>

<p>An example with functions:</p>

<pre>
    realFunc = function(msg) { alert(msg) };
    mockFunc = spy(realFunc);

    // -- start code under test --
    // the following alerts 'hello world'
    mockFunc("hello world");
    // -- end code under test --

    verify(mockFunc).call(anything(), "hello world");
</pre>

<p>or with objects:</p>

<pre>
    realObj = new Array();
    mockedObj = spy(realObj);

    when(mockedObj).pop().thenReturn("bar");

    // -- start code under test --
    mockedObject.push("foo");
    alert(realObj.length); // alerts '1'

    alert(mockedObject.pop()); // alerts 'bar'
    alert(realObj.length); // still alerts '1'
    // -- end code under test --
 
    verify(mockedObject).push("foo");
    verify(mockedObject).pop();
</pre>

<p>For more examples and documentation, look in the doc directory.</p>

<h2>Who is your bartender?</h2>

<p>This variation is served to you by <a href="http://chrisleishman.com">Chris
Leishman</a> and friends. Also a big thumbs up and thanks to the 
<a href="http://mockito.org">Mockito</a> authors for the inspiration!</p>

<p>Also thanks to the <a href="http://github.com/danielfm/jshamcrest/">JsHamcrest</a> authors, who made this easy.</p>
</body>
</html>
